// 
// Decompiled by Procyon v0.5.30
// 

package servlets;

import java.io.IOException;
import javax.servlet.ServletException;
import java.io.PrintWriter;
import java.sql.ResultSet;
import java.sql.PreparedStatement;
import java.sql.Connection;
import java.sql.SQLException;
import common.Log;
import common.Trx;
import java.util.Calendar;
import common.ComStr;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServlet;

public class DB2TXT10 extends HttpServlet
{
    public void service(final HttpServletRequest req, final HttpServletResponse res) throws ServletException, IOException {
        res.setContentType("text/html;charset=euc-kr");
        Trx trx = null;
        Connection con = null;
        PreparedStatement psmt = null;
        final PreparedStatement psmt2 = null;
        ResultSet rs = null;
        final ResultSet rs2 = null;
        String sql = null;
        String sql2 = null;
        String fileWrite = null;
        String Upche = "";
        final PrintWriter out = res.getWriter();
        String start = req.getParameter("start");
        String end = req.getParameter("end");
        final String fileName = "등록업체(신규 및 변경, 지청별) 통계조회";
        final String total = ComStr.checkNull(req.getParameter("total"), "");
        if (total.equals("0")) {
            Upche = "등록일자";
        }
        else {
            Upche = "갱신일자";
        }
        final Calendar cal = Calendar.getInstance();
        final String yearNow = Integer.toString(cal.get(1));
        final String monthNow = Integer.toString(cal.get(2) + 1);
        final String dateNow = Integer.toString(cal.get(5));
        try {
            trx = new Trx(this, "usemn");
            con = trx.getConnection();
            if (start.equals("")) {
                start = "1900-01-01";
            }
            if (end.equals("")) {
                end = String.valueOf(yearNow) + "-" + monthNow + "-" + dateNow;
            }
            start = String.valueOf(start) + " 00:00:00";
            end = String.valueOf(end) + " 23:59:59";
            sql = "Select '물품' t_name,                                                                                                    \n \t\tNvl(C01.cnt,0) 본청, Nvl(b01.cnt,0) 서울, Nvl(b02.cnt,0) 부산, Nvl(b03.cnt,0) 인천,                                 \n \t\tNvl(b04.cnt,0) 대구, Nvl(b05.cnt,0) 광주, Nvl(b06.cnt,0) 대전, Nvl(b07.cnt,0) 강원,                                 \n \t\tNvl(b08.cnt,0) 충북, Nvl(b09.cnt,0) 전북, Nvl(b10.cnt,0) 경남, Nvl(b11.cnt,0) 제주,                                 \n       Nvl(b12.cnt,0) 안동출장소, Nvl(b13.cnt,0) 강릉출장소, Nvl(b14.cnt,0) 순천출장소,                                    \n       Nvl(C01.cnt,0) + Nvl(b01.cnt,0) + Nvl(b02.cnt,0) + Nvl(b03.cnt,0) +                                                 \n \t\tNvl(b04.cnt,0) + Nvl(b05.cnt,0) + Nvl(b06.cnt,0) + Nvl(b07.cnt,0) +                                                 \n \t\tNvl(b08.cnt,0) + Nvl(b09.cnt,0) + Nvl(b10.cnt,0) + Nvl(b11.cnt,0) +                                                 \n       Nvl(b12.cnt,0) + Nvl(b13.cnt,0) + Nvl(b14.cnt,0) Tot_cnt                                                            \n  From ( -- Select 코드, 코드명 From syn_공동코드 Where 코드구분 = 'GUA') a, (                                             \n                 Select /*+ index(IDX_사용_조달업체마스터_05)*/'물품' t_name, Count(*) cnt                                 \n                  From 사용_조달업체마스터                                                                                 \n                 Where 승인지청 ='00'                                                                                      \n                   And 업무구분 Like '1____'                                                                               \n                   And 테스트여부 is null                                                                   \n                   AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) C01, (                                                                                                           \n " + "                Select '물품' t_name, Count(*) cnt                                                                        \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='12'\t-- 서울                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b01, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='21'\t-- 부산                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b02, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='22'\t-- 인천                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b03, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='23'\t-- 대구                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b04, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='24'\t-- 광주                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b05, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='25'\t-- 대전                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b06, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='32'\t-- 강원                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b07, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='33'\t-- 충북                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b08, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='35'\t-- 전북                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b09, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='38'\t-- 경남                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b10, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='39'\t-- 제주                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b11, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='81'\t-- 안동                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')  \n " + "       ) b12, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='83'\t-- 강릉                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b13, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '물품' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='87'\t-- 순천                                                                             \n " + "                  And 업무구분 Like '1____'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b14                                                                                                              \n " + "Union All                                                                                                                 \n " + "Select '공사' t_name,                                                                                                     \n " + "\t\tNvl(C01.cnt,0) 본청, Nvl(b01.cnt,0) 서울, Nvl(b02.cnt,0) 부산, Nvl(b03.cnt,0) 인천,                                 \n " + "\t\tNvl(b04.cnt,0) 대구, Nvl(b05.cnt,0) 광주, Nvl(b06.cnt,0) 대전, Nvl(b07.cnt,0) 강원,                                 \n " + "\t\tNvl(b08.cnt,0) 충북, Nvl(b09.cnt,0) 전북, Nvl(b10.cnt,0) 경남, Nvl(b11.cnt,0) 제주,                                 \n " + "      Nvl(b12.cnt,0) 안동출장소, Nvl(b13.cnt,0) 강릉출장소, Nvl(b14.cnt,0) 순천출장소,                                    \n " + "      Nvl(C01.cnt,0) + Nvl(b01.cnt,0) + Nvl(b02.cnt,0) + Nvl(b03.cnt,0) +                                                 \n " + "\t\tNvl(b04.cnt,0) + Nvl(b05.cnt,0) + Nvl(b06.cnt,0) + Nvl(b07.cnt,0) +                                                 \n " + "\t\tNvl(b08.cnt,0) + Nvl(b09.cnt,0) + Nvl(b10.cnt,0) + Nvl(b11.cnt,0) +                                                 \n " + "      Nvl(b12.cnt,0) + Nvl(b13.cnt,0) + Nvl(b14.cnt,0) Tot_cnt                                                            \n " + " From ( -- Select 코드, 코드명 From syn_공동코드 Where 코드구분 = 'GUA') a, (                                             \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='00'                                                                                      \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) C01, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='12'\t-- 서울                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b01, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='21'\t-- 부산                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b02, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='22'\t-- 인천                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b03, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='23'\t-- 대구                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b04, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='24'\t-- 광주                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b05, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='25'\t-- 대전                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b06, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='32'\t-- 강원                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b07, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='33'\t-- 충북                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b08, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='35'\t-- 전북                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b09, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='38'\t-- 경남                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b10, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='39'\t-- 제주                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b11, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='81'\t-- 안동                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b12, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='83'\t-- 강릉                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b13, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '공사' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='87'\t-- 순천                                                                             \n " + "                  And 업무구분 Like '_1___'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b14                                                                                                              \n " + "Union All                                                                                                                 \n " + "Select '용역' t_name,                                                                                                     \n " + "\t\tNvl(C01.cnt,0) 본청, Nvl(b01.cnt,0) 서울, Nvl(b02.cnt,0) 부산, Nvl(b03.cnt,0) 인천,                                 \n " + "\t\tNvl(b04.cnt,0) 대구, Nvl(b05.cnt,0) 광주, Nvl(b06.cnt,0) 대전, Nvl(b07.cnt,0) 강원,                                 \n " + "\t\tNvl(b08.cnt,0) 충북, Nvl(b09.cnt,0) 전북, Nvl(b10.cnt,0) 경남, Nvl(b11.cnt,0) 제주,                                 \n " + "      Nvl(b12.cnt,0) 안동출장소, Nvl(b13.cnt,0) 강릉출장소, Nvl(b14.cnt,0) 순천출장소,                                    \n " + "      Nvl(C01.cnt,0) + Nvl(b01.cnt,0) + Nvl(b02.cnt,0) + Nvl(b03.cnt,0) +                                                 \n " + "\t\tNvl(b04.cnt,0) + Nvl(b05.cnt,0) + Nvl(b06.cnt,0) + Nvl(b07.cnt,0) +                                                 \n " + "\t\tNvl(b08.cnt,0) + Nvl(b09.cnt,0) + Nvl(b10.cnt,0) + Nvl(b11.cnt,0) +                                                 \n " + "      Nvl(b12.cnt,0) + Nvl(b13.cnt,0) + Nvl(b14.cnt,0) Tot_cnt                                                            \n " + " From ( -- Select 코드, 코드명 From syn_공동코드 Where 코드구분 = 'GUA') a, (                                             \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='00'                                                                                      \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) C01, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='12'\t-- 서울                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b01, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='21'\t-- 부산                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b02, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='22'\t-- 인천                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b03, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='23'\t-- 대구                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b04, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='24'\t-- 광주                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b05, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='25'\t-- 대전                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b06, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='32'\t-- 강원                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b07, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='33'\t-- 충북                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b08, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='35'\t-- 전북                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b09, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='38'\t-- 경남                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b10, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='39'\t-- 제주                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss') \n " + "       ) b11, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='81'\t-- 안동                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b12, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='83'\t-- 강릉                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b13, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '용역' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='87'\t-- 순천                                                                             \n " + "                  And 업무구분 Like '__1__'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b14                                                                                                              \n ";
            sql2 = "Union All                                                                                                                 \n Select '외자' t_name,                                                                                                     \n \t\tNvl(C01.cnt,0) 본청, Nvl(b01.cnt,0) 서울, Nvl(b02.cnt,0) 부산, Nvl(b03.cnt,0) 인천,                                 \n \t\tNvl(b04.cnt,0) 대구, Nvl(b05.cnt,0) 광주, Nvl(b06.cnt,0) 대전, Nvl(b07.cnt,0) 강원,                                 \n \t\tNvl(b08.cnt,0) 충북, Nvl(b09.cnt,0) 전북, Nvl(b10.cnt,0) 경남, Nvl(b11.cnt,0) 제주,                                 \n       Nvl(b12.cnt,0) 안동출장소, Nvl(b13.cnt,0) 강릉출장소, Nvl(b14.cnt,0) 순천출장소,                                    \n       Nvl(C01.cnt,0) + Nvl(b01.cnt,0) + Nvl(b02.cnt,0) + Nvl(b03.cnt,0) +                                                 \n \t\tNvl(b04.cnt,0) + Nvl(b05.cnt,0) + Nvl(b06.cnt,0) + Nvl(b07.cnt,0) +                                                 \n \t\tNvl(b08.cnt,0) + Nvl(b09.cnt,0) + Nvl(b10.cnt,0) + Nvl(b11.cnt,0) +                                                 \n       Nvl(b12.cnt,0) + Nvl(b13.cnt,0) + Nvl(b14.cnt,0) Tot_cnt                                                            \n  From ( -- Select 코드, 코드명 From syn_공동코드 Where 코드구분 = 'GUA') a, (                                             \n                 Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n                  From 사용_조달업체마스터                                                                                 \n                 Where 승인지청 ='00'                                                                                      \n                   And 업무구분 Like '____1'                                                                               \n                   And 테스트여부 is null                                                                   \n                   AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) C01, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='12'\t-- 서울                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b01, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='21'\t-- 부산                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b02, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='22'\t-- 인천                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b03, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='23'\t-- 대구                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b04, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='24'\t-- 광주                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b05, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='25'\t-- 대전                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b06, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='32'\t-- 강원                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b07, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='33'\t-- 충북                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b08, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='35'\t-- 전북                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b09, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='38'\t-- 경남                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b10, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='39'\t-- 제주                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b11, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='81'\t-- 안동                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b12, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='83'\t-- 강릉                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b13, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '외자' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='87'\t-- 순천                                                                             \n " + "                  And 업무구분 Like '____1'                                                                               \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b14                                                                                                              \n " + "Union All                                                                                                                 \n " + "Select '국외' t_name,                                                                                                     \n " + "\t\tNvl(C01.cnt,0) 본청, Nvl(b01.cnt,0) 서울, Nvl(b02.cnt,0) 부산, Nvl(b03.cnt,0) 인천,                                 \n " + "\t\tNvl(b04.cnt,0) 대구, Nvl(b05.cnt,0) 광주, Nvl(b06.cnt,0) 대전, Nvl(b07.cnt,0) 강원,                                 \n " + "\t\tNvl(b08.cnt,0) 충북, Nvl(b09.cnt,0) 전북, Nvl(b10.cnt,0) 경남, Nvl(b11.cnt,0) 제주,                                 \n " + "      Nvl(b12.cnt,0) 안동출장소, Nvl(b13.cnt,0) 강릉출장소, Nvl(b14.cnt,0) 순천출장소,                                    \n " + "      Nvl(C01.cnt,0) + Nvl(b01.cnt,0) + Nvl(b02.cnt,0) + Nvl(b03.cnt,0) +                                                 \n " + "\t\tNvl(b04.cnt,0) + Nvl(b05.cnt,0) + Nvl(b06.cnt,0) + Nvl(b07.cnt,0) +                                                 \n " + "\t\tNvl(b08.cnt,0) + Nvl(b09.cnt,0) + Nvl(b10.cnt,0) + Nvl(b11.cnt,0) +                                                 \n " + "      Nvl(b12.cnt,0) + Nvl(b13.cnt,0) + Nvl(b14.cnt,0) Tot_cnt                                                            \n " + " From ( -- Select 코드, 코드명 From syn_공동코드 Where 코드구분 = 'GUA') a, (                                             \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='00'                                                                                      \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) C01, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='12'\t-- 서울                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b01, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='21'\t-- 부산                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b02, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='22'\t-- 인천                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b03, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='23'\t-- 대구                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b04, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='24'\t-- 광주                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b05, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='25'\t-- 대전                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b06, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='32'\t-- 강원                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b07, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='33'\t-- 충북                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b08, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='35'\t-- 전북                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b09, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='38'\t-- 경남                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b10, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='39'\t-- 제주                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b11, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='81'\t-- 안동                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b12, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='83'\t-- 강릉                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b13, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '국외' t_name, Count(*) cnt                                \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='87'\t-- 순천                                                                             \n " + "                  And Substr(사업자등록번호,1,1) like 'F%'                                                                \n " + "                  And 테스트여부 is null                                                                                  \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b14                                                                                                              \n " + "Union All                                                                                                                 \n " + "Select '미분류' t_name,                                                                                                   \n " + "\t\tNvl(C01.cnt,0) 본청, Nvl(b01.cnt,0) 서울, Nvl(b02.cnt,0) 부산, Nvl(b03.cnt,0) 인천,                                 \n " + "\t\tNvl(b04.cnt,0) 대구, Nvl(b05.cnt,0) 광주, Nvl(b06.cnt,0) 대전, Nvl(b07.cnt,0) 강원,                                 \n " + "\t\tNvl(b08.cnt,0) 충북, Nvl(b09.cnt,0) 전북, Nvl(b10.cnt,0) 경남, Nvl(b11.cnt,0) 제주,                                 \n " + "      Nvl(b12.cnt,0) 안동출장소, Nvl(b13.cnt,0) 강릉출장소, Nvl(b14.cnt,0) 순천출장소,                                    \n " + "      Nvl(C01.cnt,0) + Nvl(b01.cnt,0) + Nvl(b02.cnt,0) + Nvl(b03.cnt,0) +                                                 \n " + "\t\tNvl(b04.cnt,0) + Nvl(b05.cnt,0) + Nvl(b06.cnt,0) + Nvl(b07.cnt,0) +                                                 \n " + "\t\tNvl(b08.cnt,0) + Nvl(b09.cnt,0) + Nvl(b10.cnt,0) + Nvl(b11.cnt,0) +                                                 \n " + "      Nvl(b12.cnt,0) + Nvl(b13.cnt,0) + Nvl(b14.cnt,0) Tot_cnt                                                            \n " + " From ( -- Select 코드, 코드명 From syn_공동코드 Where 코드구분 = 'GUA') a, (                                             \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='00'                                                                                      \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) C01, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='12'\t-- 서울                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b01, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='21'\t-- 부산                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b02, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='22'\t-- 인천                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b03, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='23'\t-- 대구                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b04, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='24'\t-- 광주                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b05, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='25'\t-- 대전                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b06, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='32'\t-- 강원                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b07, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='33'\t-- 충북                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b08, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='35'\t-- 전북                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b09, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='38'\t-- 경남                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b10, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='39'\t-- 제주                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b11, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='81'\t-- 안동                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b12, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='83'\t-- 강릉                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b13, (                                                                                                           \n " + "                Select /*+ index(IDX_사용_조달업체마스터_05)*/ '미분류' t_name, Count(*) cnt                              \n " + "                 From 사용_조달업체마스터                                                                                 \n " + "                Where 승인지청 ='87'\t-- 순천                                                                             \n " + "                  And 업무구분 = '00000'                                                                                  \n " + "                  And 테스트여부 is null                                                                   \n " + "                  AND " + Upche + " BETWEEN TO_DATE('" + start + "', 'yyyy-mm-dd hh24:mi:ss')  AND TO_DATE('" + end + "', 'yyyy-mm-dd hh24:mi:ss')       \n " + "       ) b14                                                                                                              \n ";
            psmt = con.prepareStatement(String.valueOf(sql) + sql2);
            rs = psmt.executeQuery();
            psmt.clearParameters();
            String chk = "";
            if (total.equals("0")) {
                chk = "V^";
            }
            else if (total.equals("1")) {
                chk = "^V";
            }
            fileWrite = String.valueOf(chk) + "^";
            fileWrite = String.valueOf(fileWrite) + start.substring(0, 10) + "^";
            fileWrite = String.valueOf(fileWrite) + end.substring(0, 10) + "^\r\n";
            if (rs != null) {
                while (rs.next()) {
                    fileWrite = String.valueOf(fileWrite) + ComStr.checkNull(rs.getString(1)) + "^" + ComStr.checkNull(rs.getString(17)) + "^" + ComStr.checkNull(rs.getString(2)) + "^" + ComStr.checkNull(rs.getString(3)) + "^" + ComStr.checkNull(rs.getString(4)) + "^" + ComStr.checkNull(rs.getString(5)) + "^" + ComStr.checkNull(rs.getString(6)) + "^" + ComStr.checkNull(rs.getString(7)) + "^" + ComStr.checkNull(rs.getString(8)) + "^" + ComStr.checkNull(rs.getString(9)) + "^" + ComStr.checkNull(rs.getString(10)) + "^" + ComStr.checkNull(rs.getString(11)) + "^" + ComStr.checkNull(rs.getString(12)) + "^" + ComStr.checkNull(rs.getString(13)) + "^" + ComStr.checkNull(rs.getString(14)) + "^" + ComStr.checkNull(rs.getString(15)) + "^" + ComStr.checkNull(rs.getString(16)) + "^ \r\n";
                }
            }
            fileWrite = String.valueOf(fileWrite) + "//EOR//\r\n";
        }
        catch (SQLException e) {
            Log.errors(this.getClass().getName() + " SQLException 발생함 \n" + sql + " " + e);
        }
        catch (Exception e2) {
            Log.errors(this.getClass().getName() + " Exception 발생함 " + e2);
        }
        finally {
            if (rs != null) {
                try {
                    rs.close();
                }
                catch (Exception ex) {}
            }
            if (psmt != null) {
                try {
                    psmt.close();
                }
                catch (Exception ex2) {}
            }
            if (con != null) {
                try {
                    trx.close();
                }
                catch (Exception ex3) {}
            }
        }
        if (rs != null) {
            try {
                rs.close();
            }
            catch (Exception ex4) {}
        }
        if (psmt != null) {
            try {
                psmt.close();
            }
            catch (Exception ex5) {}
        }
        if (con != null) {
            try {
                trx.close();
            }
            catch (Exception ex6) {}
        }
        out.println(fileWrite);
    }
}
